{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\covid19\\\\client\\\\src\\\\components\\\\messages\\\\ChatWrapper.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n           subscription ($last_received_id: String, $last_received_ts: String, $first_received_date: date){\\n            message (\\n              order_by: {\\n                date: asc,\\n                timestamp: asc\\n              }\\n              where: {\\n                _and: {\\n                  id: {\\n                    _neq: $last_received_id\\n                  },\\n                  timestamp: {\\n                    _gte: $last_received_ts\\n                  },\\n                  date: {\\n                    _gte: $first_received_date\\n                  }\\n                }\\n              }\\n            ) {\\n              id\\n              body\\n              username\\n              from\\n              time\\n              timestamp\\n              date\\n              created_at\\n            }\\n          }\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component, Fragment } from \"react\";\nimport gql from \"graphql-tag\";\nimport { withApollo, Subscription } from 'react-apollo';\nimport Message from \"./Message\";\nimport Spinner from 'evergreen-ui/commonjs/spinner/src/Spinner';\nimport Pane from 'evergreen-ui/commonjs/layers/src/Pane';\nimport Scroll from \"./Scroll\";\n\nvar ChatWrapper = /*#__PURE__*/function (_Component) {\n  _inherits(ChatWrapper, _Component);\n\n  var _super = _createSuper(ChatWrapper);\n\n  function ChatWrapper(props) {\n    var _this;\n\n    _classCallCheck(this, ChatWrapper);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"scrollToBottom\", function () {\n      _this.scrollRef.current.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    });\n\n    _this.client = props.client; // this.scrollRef = React.createRef();\n    // this.newMessages = data.messages;\n\n    return _this;\n  }\n\n  _createClass(ChatWrapper, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {// this.scrollToBottom()\n    }\n  }, {\n    key: \"render\",\n    // componentDidUpdate() {\n    //  if (this.newMessages.length === 0) {\n    //    this.scrollToBottom();\n    //  }\n    // }\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(\"div\", {\n        className: \"jsx-2531664993\" + \" \" + \"messageWrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 7\n        }\n      }, __jsx(Subscription, {\n        subscription: gql(_templateObject()),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 9\n        }\n      }, function (_ref) {\n        var loading = _ref.loading,\n            error = _ref.error,\n            data = _ref.data;\n\n        if (loading) {\n          return __jsx(\"div\", {\n            className: \"jsx-2531664993\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 19\n            }\n          }, __jsx(Pane, {\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            height: 280,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 13\n            }\n          }, __jsx(Spinner, {\n            size: 28,\n            marginX: \"auto\",\n            marginY: 120,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 11\n            }\n          })));\n        }\n\n        if (error) {\n          console.error(error);\n          return __jsx(\"span\", {\n            className: \"jsx-2531664993\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 19\n            }\n          }, \" Error Fetching Message Subscription!\");\n        }\n\n        if (data) {\n          var messages = data.message;\n          var messagesList = [];\n          messages.forEach(function (message, index) {\n            messagesList.push(__jsx(Message, {\n              key: index,\n              index: index,\n              message: message,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 15\n              }\n            }));\n          });\n          return __jsx(\"div\", {\n            className: \"jsx-2531664993\" + \" \" + \"chatDialog\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 13\n            }\n          }, __jsx(Fragment, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 13\n            }\n          }, messagesList, __jsx(Scroll, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 15\n            }\n          })));\n        }\n      }), __jsx(_JSXStyle, {\n        id: \"2531664993\",\n        __self: this\n      }, \".chatDialog.jsx-2531664993{height:800px;overflow-y:scroll;overflow-x:hidden;}.jsx-2531664993::-webkit-scrollbar-track{border-radius:10px;background:rgba(0,0,0,0.1);border:1px solid #ccc;}.jsx-2531664993::-webkit-scrollbar-thumb{border-radius:10px;background:linear-gradient(left,#fff,#e4e4e4);border:1px solid #aaa;}.jsx-2531664993::-webkit-scrollbar-thumb:hover{background:#fff;}.jsx-2531664993::-webkit-scrollbar-thumb:active{background:linear-gradient(left,#22ADD4,#1E98BA);}.jsx-2531664993::-webkit-scrollbar{width:12px;}.conversationNameContainer.jsx-2531664993:{backgroundColor:'#fafafa', padding:20, borderBottom:'1px solid #ddd';}.conversationName.jsx-2531664993:{margin:0, fontSize:16, fontWeight:500;}.scroller.jsx-2531664993:{float:\\\"left\\\",clear:\\\"both\\\";}.messagesContainer.jsx-2531664993:{height:'calc(100vh - 219px)', overflow:'scroll',;}.message.jsx-2531664993:{backgroundColor:\\\"#ededed\\\", borderRadius:10, margin:10, padding:20;}.messageText.jsx-2531664993:{margin:0;}.input.jsx-2531664993:{height:45, outline:'none', border:'2px solid #ededed', margin:5, borderRadius:30, padding:'0px 20px', fontSize:18, width:'calc(100% - 54px)';}.inputContainer.jsx-2531664993:{width:'100%', position:'absolute', bottom:50, left:0,;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxjb3ZpZDE5XFxjbGllbnRcXHNyY1xcY29tcG9uZW50c1xcbWVzc2FnZXNcXENoYXRXcmFwcGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXNHZ0IsQUFLb0IsQUFNTSxBQU1BLEFBTUgsQUFJbUMsQUFJeEMsQUFRZCxBQU1BLEFBSUEsQUFLQSxBQU9BLEFBSUEsQUFXQSxBQU9BLFNBbEJDLEVBakNBLEVBMUJvQixHQWtCcEIsR0FaNkIsQUFNcUIsT0ErQmxELEtBMUNvQixPQXNDcEIsUUFoQ3dCLEdBTHhCLEFBb0JBLEFBMEJBLEtBNkJBLFdBaEV3QixDQTBDeEIsRUEvQ0EsQ0F5QkEsa0JBbkJBLHNEQXdEQSIsImZpbGUiOiJDOlxcY292aWQxOVxcY2xpZW50XFxzcmNcXGNvbXBvbmVudHNcXG1lc3NhZ2VzXFxDaGF0V3JhcHBlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQsIEZyYWdtZW50IH0gZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBncWwgZnJvbSBcImdyYXBocWwtdGFnXCI7XHJcbmltcG9ydCB7d2l0aEFwb2xsbywgU3Vic2NyaXB0aW9ufSBmcm9tICdyZWFjdC1hcG9sbG8nO1xyXG5cclxuaW1wb3J0IE1lc3NhZ2UgZnJvbSBcIi4vTWVzc2FnZVwiO1xyXG5pbXBvcnQgU3Bpbm5lciBmcm9tICdldmVyZ3JlZW4tdWkvY29tbW9uanMvc3Bpbm5lci9zcmMvU3Bpbm5lcidcclxuaW1wb3J0IFBhbmUgZnJvbSAnZXZlcmdyZWVuLXVpL2NvbW1vbmpzL2xheWVycy9zcmMvUGFuZSdcclxuaW1wb3J0IFNjcm9sbCBmcm9tIFwiLi9TY3JvbGxcIjtcclxuXHJcblxyXG5jbGFzcyBDaGF0V3JhcHBlciBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuY2xpZW50ID0gcHJvcHMuY2xpZW50O1xyXG4gICAgLy8gdGhpcy5zY3JvbGxSZWYgPSBSZWFjdC5jcmVhdGVSZWYoKTtcclxuICAgIC8vIHRoaXMubmV3TWVzc2FnZXMgPSBkYXRhLm1lc3NhZ2VzO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICAvLyB0aGlzLnNjcm9sbFRvQm90dG9tKClcclxuICB9XHJcblxyXG4gIHNjcm9sbFRvQm90dG9tID0gKCkgPT4ge1xyXG4gICAgdGhpcy5zY3JvbGxSZWYuY3VycmVudC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiBcInNtb290aFwiIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gY29tcG9uZW50RGlkVXBkYXRlKCkge1xyXG4gIC8vICBpZiAodGhpcy5uZXdNZXNzYWdlcy5sZW5ndGggPT09IDApIHtcclxuICAvLyAgICB0aGlzLnNjcm9sbFRvQm90dG9tKCk7XHJcbiAgLy8gIH1cclxuICAvLyB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWVzc2FnZVdyYXBwZXJcIj5cclxuICAgICAgICA8U3Vic2NyaXB0aW9uIHN1YnNjcmlwdGlvbj17Z3FsYFxyXG4gICAgICAgICAgIHN1YnNjcmlwdGlvbiAoJGxhc3RfcmVjZWl2ZWRfaWQ6IFN0cmluZywgJGxhc3RfcmVjZWl2ZWRfdHM6IFN0cmluZywgJGZpcnN0X3JlY2VpdmVkX2RhdGU6IGRhdGUpe1xyXG4gICAgICAgICAgICBtZXNzYWdlIChcclxuICAgICAgICAgICAgICBvcmRlcl9ieToge1xyXG4gICAgICAgICAgICAgICAgZGF0ZTogYXNjLFxyXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBhc2NcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgIF9hbmQ6IHtcclxuICAgICAgICAgICAgICAgICAgaWQ6IHtcclxuICAgICAgICAgICAgICAgICAgICBfbmVxOiAkbGFzdF9yZWNlaXZlZF9pZFxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHtcclxuICAgICAgICAgICAgICAgICAgICBfZ3RlOiAkbGFzdF9yZWNlaXZlZF90c1xyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICBkYXRlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2d0ZTogJGZpcnN0X3JlY2VpdmVkX2RhdGVcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgaWRcclxuICAgICAgICAgICAgICBib2R5XHJcbiAgICAgICAgICAgICAgdXNlcm5hbWVcclxuICAgICAgICAgICAgICBmcm9tXHJcbiAgICAgICAgICAgICAgdGltZVxyXG4gICAgICAgICAgICAgIHRpbWVzdGFtcFxyXG4gICAgICAgICAgICAgIGRhdGVcclxuICAgICAgICAgICAgICBjcmVhdGVkX2F0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1gfT5cclxuICAgICAgeyh7IGxvYWRpbmcsIGVycm9yLCBkYXRhIH0pID0+IHtcclxuICAgICAgICBpZiAobG9hZGluZykge1xyXG4gICAgICAgICAgcmV0dXJuICg8ZGl2PlxyXG4gICAgICAgICAgICA8UGFuZSBkaXNwbGF5PVwiZmxleFwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIiBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGhlaWdodD17MjgwfT5cclxuICAgICAgICAgIDxTcGlubmVyIHNpemU9ezI4fSBtYXJnaW5YPVwiYXV0b1wiIG1hcmdpblk9ezEyMH0gIC8+XHJcbiAgICAgICAgICAgIDwvUGFuZT5cclxuICAgICAgICA8L2Rpdj4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgcmV0dXJuICg8c3Bhbj4gRXJyb3IgRmV0Y2hpbmcgTWVzc2FnZSBTdWJzY3JpcHRpb24hPC9zcGFuPik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhKSB7XHJcblxyXG4gICAgICAgICAgY29uc3QgbWVzc2FnZXMgPSBkYXRhLm1lc3NhZ2U7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnN0IG1lc3NhZ2VzTGlzdCA9IFtdO1xyXG4gICAgICAgICAgbWVzc2FnZXMuZm9yRWFjaCgobWVzc2FnZSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgbWVzc2FnZXNMaXN0LnB1c2goXHJcbiAgICAgICAgICAgICAgPE1lc3NhZ2VcclxuICAgICAgICAgICAgICAgIGtleT17aW5kZXh9XHJcbiAgICAgICAgICAgICAgICBpbmRleD17aW5kZXh9XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlPXttZXNzYWdlfVxyXG4gICAgICAgICAgICAgIC8+KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjaGF0RGlhbG9nXCI+XHJcbiAgICAgICAgICAgIDxGcmFnbWVudD5cclxuICAgICAgICAgICAgICB7bWVzc2FnZXNMaXN0fVxyXG4gICAgICAgICAgICAgIDxTY3JvbGwgLz5cclxuICAgICAgICAgICAgPC9GcmFnbWVudD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfX1cclxuICAgIDwvU3Vic2NyaXB0aW9uPlxyXG4gICAgPHN0eWxlIGpzeD57YFxyXG4gICAgXHJcblxyXG4gICAgLmNoYXREaWFsb2cge1xyXG4gICAgICBoZWlnaHQ6IDgwMHB4O1xyXG4gICAgICBvdmVyZmxvdy15OiBzY3JvbGw7XHJcbiAgICAgIG92ZXJmbG93LXg6IGhpZGRlbjtcclxuICAgIH1cclxuXHJcbiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHtcclxuICAgICAgYm9yZGVyLXJhZGl1czogMTBweDtcclxuICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjEpO1xyXG4gICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcclxuICAgICAgYm9yZGVyLXJhZGl1czogMTBweDtcclxuICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KGxlZnQsICNmZmYsICNlNGU0ZTQpO1xyXG4gICAgICBib3JkZXI6IDFweCBzb2xpZCAjYWFhO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHtcclxuICAgICAgYmFja2dyb3VuZDogI2ZmZjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjphY3RpdmUge1xyXG4gICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQobGVmdCwgIzIyQURENCwgIzFFOThCQSk7XHJcbiAgICB9XHJcblxyXG4gICAgOjotd2Via2l0LXNjcm9sbGJhciB7XHJcbiAgICAgIHdpZHRoOiAxMnB4O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAuY29udmVyc2F0aW9uTmFtZUNvbnRhaW5lcjoge1xyXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjZmFmYWZhJyxcclxuICAgICAgcGFkZGluZzogMjAsXHJcbiAgICAgIGJvcmRlckJvdHRvbTogJzFweCBzb2xpZCAjZGRkJ1xyXG4gICAgfVxyXG5cclxuICAgIC5jb252ZXJzYXRpb25OYW1lOiB7XHJcbiAgICAgIG1hcmdpbjogMCxcclxuICAgICAgZm9udFNpemU6IDE2LFxyXG4gICAgICBmb250V2VpZ2h0OiA1MDBcclxuICAgIH1cclxuXHJcbiAgICAuc2Nyb2xsZXI6IHtcclxuICAgICAgZmxvYXQ6XCJsZWZ0XCIsIGNsZWFyOiBcImJvdGhcIlxyXG4gICAgfVxyXG5cclxuICAgIC5tZXNzYWdlc0NvbnRhaW5lcjoge1xyXG4gICAgICBoZWlnaHQ6ICdjYWxjKDEwMHZoIC0gMjE5cHgpJyxcclxuICAgICAgb3ZlcmZsb3c6ICdzY3JvbGwnLCAgIFxyXG4gICAgfVxyXG5cclxuICAgIC5tZXNzYWdlOiB7XHJcbiAgICAgIGJhY2tncm91bmRDb2xvcjogXCIjZWRlZGVkXCIsXHJcbiAgICAgIGJvcmRlclJhZGl1czogMTAsXHJcbiAgICAgIG1hcmdpbjogMTAsXHJcbiAgICAgIHBhZGRpbmc6IDIwXHJcbiAgICB9XHJcblxyXG4gICAgLm1lc3NhZ2VUZXh0OiB7XHJcbiAgICAgIG1hcmdpbjogMFxyXG4gICAgfVxyXG5cclxuICAgIC5pbnB1dDoge1xyXG4gICAgICBoZWlnaHQ6IDQ1LFxyXG4gICAgICBvdXRsaW5lOiAnbm9uZScsXHJcbiAgICAgIGJvcmRlcjogJzJweCBzb2xpZCAjZWRlZGVkJyxcclxuICAgICAgbWFyZ2luOiA1LFxyXG4gICAgICBib3JkZXJSYWRpdXM6IDMwLFxyXG4gICAgICBwYWRkaW5nOiAnMHB4IDIwcHgnLFxyXG4gICAgICBmb250U2l6ZTogMTgsXHJcbiAgICAgIHdpZHRoOiAnY2FsYygxMDAlIC0gNTRweCknXHJcbiAgICB9XHJcblxyXG4gICAgLmlucHV0Q29udGFpbmVyOiB7XHJcbiAgICAgIHdpZHRoOiAnMTAwJScsXHJcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxyXG4gICAgICBib3R0b206IDUwLFxyXG4gICAgICBsZWZ0OiAwLFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBgfTwvc3R5bGU+XHJcbiAgICA8L2Rpdj5cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCB3aXRoQXBvbGxvKENoYXRXcmFwcGVyKTsiXX0= */\\n/*@ sourceURL=C:\\\\\\\\covid19\\\\\\\\client\\\\\\\\src\\\\\\\\components\\\\\\\\messages\\\\\\\\ChatWrapper.js */\"));\n    }\n  }]);\n\n  return ChatWrapper;\n}(Component);\n\nexport default withApollo(ChatWrapper);","map":{"version":3,"sources":["C:/covid19/client/src/components/messages/ChatWrapper.js"],"names":["React","Component","Fragment","gql","withApollo","Subscription","Message","Spinner","Pane","Scroll","ChatWrapper","props","scrollRef","current","scrollIntoView","behavior","client","loading","error","data","console","messages","message","messagesList","forEach","index","push"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,SAAQC,UAAR,EAAoBC,YAApB,QAAuC,cAAvC;AAEA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,OAAP,MAAoB,2CAApB;AACA,OAAOC,IAAP,MAAiB,uCAAjB;AACA,OAAOC,MAAP,MAAmB,UAAnB;;IAGMC,W;;;;;AACJ,uBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,qEAWF,YAAM;AACrB,YAAKC,SAAL,CAAeC,OAAf,CAAuBC,cAAvB,CAAsC;AAAEC,QAAAA,QAAQ,EAAE;AAAZ,OAAtC;AACD,KAbkB;;AAEjB,UAAKC,MAAL,GAAcL,KAAK,CAACK,MAApB,CAFiB,CAGjB;AACA;;AAJiB;AAKlB;;;;wCAEmB,CAClB;AACD;;;AAMD;AACA;AACA;AACA;AACA;6BAES;AAAA;;AACP,aACE;AAAA,4CAAe,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,YAAD;AAAc,QAAA,YAAY,EAAEb,GAAF,mBAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SA+BD,gBAA8B;AAAA,YAA3Bc,OAA2B,QAA3BA,OAA2B;AAAA,YAAlBC,KAAkB,QAAlBA,KAAkB;AAAA,YAAXC,IAAW,QAAXA,IAAW;;AAC7B,YAAIF,OAAJ,EAAa;AACX,iBAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACN,MAAC,IAAD;AAAM,YAAA,OAAO,EAAC,MAAd;AAAqB,YAAA,UAAU,EAAC,QAAhC;AAAyC,YAAA,cAAc,EAAC,QAAxD;AAAiE,YAAA,MAAM,EAAE,GAAzE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACF,MAAC,OAAD;AAAS,YAAA,IAAI,EAAE,EAAf;AAAmB,YAAA,OAAO,EAAC,MAA3B;AAAkC,YAAA,OAAO,EAAE,GAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADE,CADM,CAAR;AAKD;;AACD,YAAIC,KAAJ,EAAW;AACTE,UAAAA,OAAO,CAACF,KAAR,CAAcA,KAAd;AACA,iBAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qDAAR;AACD;;AACD,YAAIC,IAAJ,EAAU;AAER,cAAME,QAAQ,GAAGF,IAAI,CAACG,OAAtB;AAEA,cAAMC,YAAY,GAAG,EAArB;AACAF,UAAAA,QAAQ,CAACG,OAAT,CAAiB,UAACF,OAAD,EAAUG,KAAV,EAAoB;AACnCF,YAAAA,YAAY,CAACG,IAAb,CACE,MAAC,OAAD;AACE,cAAA,GAAG,EAAED,KADP;AAEE,cAAA,KAAK,EAAEA,KAFT;AAGE,cAAA,OAAO,EAAEH,OAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF;AAMD,WAPD;AAQA,iBACE;AAAA,gDAAe,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACA,MAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACGC,YADH,EAEE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFF,CADA,CADF;AAQD;AACF,OAjEC,CADF;AAAA;AAAA;AAAA,izQADF;AA4JD;;;;EAnLuBtB,S;;AAsL1B,eAAeG,UAAU,CAACM,WAAD,CAAzB","sourcesContent":["import React, { Component, Fragment } from \"react\";\r\nimport gql from \"graphql-tag\";\r\nimport {withApollo, Subscription} from 'react-apollo';\r\n\r\nimport Message from \"./Message\";\r\nimport Spinner from 'evergreen-ui/commonjs/spinner/src/Spinner'\r\nimport Pane from 'evergreen-ui/commonjs/layers/src/Pane'\r\nimport Scroll from \"./Scroll\";\r\n\r\n\r\nclass ChatWrapper extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.client = props.client;\r\n    // this.scrollRef = React.createRef();\r\n    // this.newMessages = data.messages;\r\n  }\r\n\r\n  componentDidMount() {\r\n    // this.scrollToBottom()\r\n  }\r\n\r\n  scrollToBottom = () => {\r\n    this.scrollRef.current.scrollIntoView({ behavior: \"smooth\" });\r\n  }\r\n\r\n  // componentDidUpdate() {\r\n  //  if (this.newMessages.length === 0) {\r\n  //    this.scrollToBottom();\r\n  //  }\r\n  // }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"messageWrapper\">\r\n        <Subscription subscription={gql`\r\n           subscription ($last_received_id: String, $last_received_ts: String, $first_received_date: date){\r\n            message (\r\n              order_by: {\r\n                date: asc,\r\n                timestamp: asc\r\n              }\r\n              where: {\r\n                _and: {\r\n                  id: {\r\n                    _neq: $last_received_id\r\n                  },\r\n                  timestamp: {\r\n                    _gte: $last_received_ts\r\n                  },\r\n                  date: {\r\n                    _gte: $first_received_date\r\n                  }\r\n                }\r\n              }\r\n            ) {\r\n              id\r\n              body\r\n              username\r\n              from\r\n              time\r\n              timestamp\r\n              date\r\n              created_at\r\n            }\r\n          }`}>\r\n      {({ loading, error, data }) => {\r\n        if (loading) {\r\n          return (<div>\r\n            <Pane display=\"flex\" alignItems=\"center\" justifyContent=\"center\" height={280}>\r\n          <Spinner size={28} marginX=\"auto\" marginY={120}  />\r\n            </Pane>\r\n        </div>);\r\n        }\r\n        if (error) {\r\n          console.error(error);\r\n          return (<span> Error Fetching Message Subscription!</span>);\r\n        }\r\n        if (data) {\r\n\r\n          const messages = data.message;\r\n          \r\n          const messagesList = [];\r\n          messages.forEach((message, index) => {\r\n            messagesList.push(\r\n              <Message\r\n                key={index}\r\n                index={index}\r\n                message={message}\r\n              />);\r\n          });\r\n          return (\r\n            <div className=\"chatDialog\">\r\n            <Fragment>\r\n              {messagesList}\r\n              <Scroll />\r\n            </Fragment>\r\n            </div>\r\n          );\r\n        }\r\n      }}\r\n    </Subscription>\r\n    <style jsx>{`\r\n    \r\n\r\n    .chatDialog {\r\n      height: 800px;\r\n      overflow-y: scroll;\r\n      overflow-x: hidden;\r\n    }\r\n\r\n    ::-webkit-scrollbar-track {\r\n      border-radius: 10px;\r\n      background: rgba(0,0,0,0.1);\r\n      border: 1px solid #ccc;\r\n    }\r\n    \r\n    ::-webkit-scrollbar-thumb {\r\n      border-radius: 10px;\r\n      background: linear-gradient(left, #fff, #e4e4e4);\r\n      border: 1px solid #aaa;\r\n    }\r\n    \r\n    ::-webkit-scrollbar-thumb:hover {\r\n      background: #fff;\r\n    }\r\n    \r\n    ::-webkit-scrollbar-thumb:active {\r\n      background: linear-gradient(left, #22ADD4, #1E98BA);\r\n    }\r\n\r\n    ::-webkit-scrollbar {\r\n      width: 12px;\r\n    }\r\n\r\n\r\n    .conversationNameContainer: {\r\n      backgroundColor: '#fafafa',\r\n      padding: 20,\r\n      borderBottom: '1px solid #ddd'\r\n    }\r\n\r\n    .conversationName: {\r\n      margin: 0,\r\n      fontSize: 16,\r\n      fontWeight: 500\r\n    }\r\n\r\n    .scroller: {\r\n      float:\"left\", clear: \"both\"\r\n    }\r\n\r\n    .messagesContainer: {\r\n      height: 'calc(100vh - 219px)',\r\n      overflow: 'scroll',   \r\n    }\r\n\r\n    .message: {\r\n      backgroundColor: \"#ededed\",\r\n      borderRadius: 10,\r\n      margin: 10,\r\n      padding: 20\r\n    }\r\n\r\n    .messageText: {\r\n      margin: 0\r\n    }\r\n\r\n    .input: {\r\n      height: 45,\r\n      outline: 'none',\r\n      border: '2px solid #ededed',\r\n      margin: 5,\r\n      borderRadius: 30,\r\n      padding: '0px 20px',\r\n      fontSize: 18,\r\n      width: 'calc(100% - 54px)'\r\n    }\r\n\r\n    .inputContainer: {\r\n      width: '100%',\r\n      position: 'absolute',\r\n      bottom: 50,\r\n      left: 0,\r\n    }\r\n    \r\n    `}</style>\r\n    </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withApollo(ChatWrapper);"]},"metadata":{},"sourceType":"module"}