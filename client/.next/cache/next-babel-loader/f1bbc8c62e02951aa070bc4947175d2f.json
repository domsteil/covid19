{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"C:\\\\covid19\\\\client\\\\src\\\\components\\\\messages\\\\Textbox.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\nmutation ($username: String) {\\n  update_users (\\n    _set: {\\n      last_typed: \\\"now()\\\"\\n    }\\n    where: {\\n      username: {\\n        _eq: $username\\n      }\\n    }\\n  ) {\\n    affected_rows\\n  }\\n}\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\nmutation insert_message ($message: message_insert_input! ){\\n  insert_message (\\n    objects: [$message]\\n  ) {\\n    returning {\\n      id\\n      time\\n      body\\n      username\\n    }\\n  }\\n}\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from 'react';\nimport { Mutation } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport TypingIndicator from './TypingIndicator';\nimport { distanceInWordsToNow, isToday } from 'date-fns';\nimport { useContext } from 'react';\nimport UserContext from '../UserContext';\nvar insertMessage = gql(_templateObject());\nvar emitTypingEvent = gql(_templateObject2());\n\nvar Textbox = /*#__PURE__*/function (_React$Component) {\n  _inherits(Textbox, _React$Component);\n\n  var _super = _createSuper(Textbox);\n\n  function Textbox(props) {\n    var _this;\n\n    _classCallCheck(this, Textbox);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTyping\", function (body, mutate) {\n      var textLength = body.length;\n\n      if (textLength !== 0 && textLength % 5 === 0 || textLength === 1) {\n        _this.emitTypingEvent(mutate);\n      }\n\n      _this.setState({\n        body: body\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"emitTypingEvent\", function _callee(mutate) {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!_this.context.user) {\n                _context.next = 3;\n                break;\n              }\n\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(mutate({\n                mutation: emitTypingEvent,\n                variables: {\n                  username: _this.context.user\n                }\n              }));\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"form\", function (sendMessage, client) {\n      return __jsx(\"form\", {\n        onSubmit: sendMessage,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 7\n        }\n      }, __jsx(\"div\", {\n        className: \"jsx-2572678404\" + \" \" + \"column\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 9\n        }\n      }, __jsx(TypingIndicator, {\n        username: _this.context.user,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }\n      }), __jsx(\"input\", {\n        id: \"textbox\",\n        placeholder: \"Type a Message...\",\n        value: _this.state.body,\n        autoFocus: true,\n        onChange: function onChange(e) {\n          _this.handleTyping(e.target.value, client.mutate);\n        },\n        autoComplete: \"on\",\n        className: \"jsx-2572678404\" + \" \" + \"message-box\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }\n      }), __jsx(_JSXStyle, {\n        id: \"2572678404\",\n        __self: _assertThisInitialized(_this)\n      }, \".column.jsx-2572678404{text-align:center;border-width:1px;list-style:none;padding-bottom:28px;margin-right:28px;}.to.jsx-2572678404{width:260px;padding-bottom:8px;padding-top:8px;border:1px solid #d0d4d9;border-radius:.375rem;-webkit-box-shadow:inset 0 -1px 0 0 rgba(100,121,143,0.122);box-shadow:inset 0 -1px 0 0 rgba(100,121,143,0.122);line-height:20px;min-height:auto;}.message-box.jsx-2572678404{width:1100px;overflow:auto;min-height:42px;height:38px;max-height:180px;border-width:2px;border-style:solid;border-color:rgb(234,234,234);border-image:initial;border-radius:.375rem;border:1px solid #bdc4c9;outline:0;background:#fff;resize:none;box-shadow:none;color:#1d1c1d;-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;user-select:auto;padding:9px 28px 10px 28px;}.login.jsx-2572678404{color:#FFF;}.account.jsx-2572678404{font-size:13px;line-height:1.91667;font-weight:400;color:#3d464d;border:1px solid #bdc4c9;padding:3.5px 7px;border-radius:4px;margin-top:28px;margin-left:8px;}.row.jsx-2572678404{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin:-1.5rem 0;text-align:center;}@media screen and (max-width:960px){.row.jsx-2572678404{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin:-1.5rem 0;}.column.jsx-2572678404{width:8%;padding:1.5rem 0;text-align:center;max-width:100px;}.message-box.jsx-2572678404{padding-bottom:28px;width:400px;min-height:42px;height:38px;max-height:180px;border-width:2px;border-style:solid;margin-left:-33px;margin-right:20px;border-color:rgb(234,234,234);border-image:initial;border-radius:.375rem;border:1px solid #bdc4c9;outline:0;background:#FFFFFF;resize:none;box-shadow:none;color:#1d1c1d;padding:9px 30px 10px 50px;}}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxjb3ZpZDE5XFxjbGllbnRcXHNyY1xcY29tcG9uZW50c1xcbWVzc2FnZXNcXFRleHRib3guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBa0pzQixBQUlxQixBQVFOLEFBWUMsQUF3QkYsQUFJSSxBQVlPLEFBUUUsQUFJYixBQU9XLFNBTkgsRUE1QnJCLENBcENxQixDQVlMLEVBNEJNLEdBaERILEVBK0VILE1BTk0sQ0FwREosSUFaQSxDQXVFRSxHQS9FRixBQWdEQSxRQTNCSixDQW9ETSxHQWhFTyxDQXVFWCxHQS9FTSxBQWdETixJQTNCRyxLQW9EakIsQUFPbUIsS0EvQk0sTUFoRFAsQ0FRSSxBQWFMLEtBMkRFLENBdkJGLEFBUUUsV0FoRXJCLEFBcUJxQixDQTJCRCxJQXhDMEMsQUF3RXZDLENBdkJILEFBUWxCLGFBM0NnQyxBQTJCZCxLQVNwQixBQXVCc0IsYUEvQkosS0FnQ0ksT0EzREMsSUE0QkwsT0FnQ2tCLEtBMUVrQixJQTJDdEQsQ0E1QndCLG9CQTREQyxFQTNERSxtQkE0REQsTUEzRVAsQUFnQlAsVUFDTSxNQTJEVyxDQTNFWCxTQWlCSixPQWhCZCxLQWlCa0IsR0EwREosVUFDUyxHQTFEUCxjQUNXLEVBMERYLFlBQ0ksV0ExREksS0EyRE4sY0FDYSxHQTNEUixxQkFDSixHQTJEakIsa0ZBMUQyQiwyQkFDN0IiLCJmaWxlIjoiQzpcXGNvdmlkMTlcXGNsaWVudFxcc3JjXFxjb21wb25lbnRzXFxtZXNzYWdlc1xcVGV4dGJveC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IE11dGF0aW9uIH0gZnJvbSAncmVhY3QtYXBvbGxvJztcclxuaW1wb3J0IGdxbCBmcm9tICdncmFwaHFsLXRhZyc7XHJcbmltcG9ydCBUeXBpbmdJbmRpY2F0b3IgZnJvbSAnLi9UeXBpbmdJbmRpY2F0b3InO1xyXG5pbXBvcnQgeyBkaXN0YW5jZUluV29yZHNUb05vdywgaXNUb2RheSB9IGZyb20gJ2RhdGUtZm5zJztcclxuaW1wb3J0IHsgdXNlQ29udGV4dCB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IFVzZXJDb250ZXh0IGZyb20gJy4uL1VzZXJDb250ZXh0JztcclxuXHJcbmNvbnN0IGluc2VydE1lc3NhZ2UgPSBncWxgXHJcbm11dGF0aW9uIGluc2VydF9tZXNzYWdlICgkbWVzc2FnZTogbWVzc2FnZV9pbnNlcnRfaW5wdXQhICl7XHJcbiAgaW5zZXJ0X21lc3NhZ2UgKFxyXG4gICAgb2JqZWN0czogWyRtZXNzYWdlXVxyXG4gICkge1xyXG4gICAgcmV0dXJuaW5nIHtcclxuICAgICAgaWRcclxuICAgICAgdGltZVxyXG4gICAgICBib2R5XHJcbiAgICAgIHVzZXJuYW1lXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmA7XHJcblxyXG5jb25zdCBlbWl0VHlwaW5nRXZlbnQgPSBncWxgXHJcbm11dGF0aW9uICgkdXNlcm5hbWU6IFN0cmluZykge1xyXG4gIHVwZGF0ZV91c2VycyAoXHJcbiAgICBfc2V0OiB7XHJcbiAgICAgIGxhc3RfdHlwZWQ6IFwibm93KClcIlxyXG4gICAgfVxyXG4gICAgd2hlcmU6IHtcclxuICAgICAgdXNlcm5hbWU6IHtcclxuICAgICAgICBfZXE6ICR1c2VybmFtZVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKSB7XHJcbiAgICBhZmZlY3RlZF9yb3dzXHJcbiAgfVxyXG59XHJcbmA7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGV4dGJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcblxyXG4gIHN0YXRpYyBjb250ZXh0VHlwZSA9IFVzZXJDb250ZXh0O1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICBzdXBlcigpXHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICB1c2VyOiB0aGlzLmNvbnRleHQsXHJcbiAgICAgIGJvZHk6IFwiXCIsXHJcbiAgICAgIHJhbmRvbTogMCxcclxuICAgICAgY3VyVGltZTogXCJcIixcclxuICAgICAgY3VyRGF0ZTogXCJcIlxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuXHJcbiAgaGFuZGxlVHlwaW5nID0gKGJvZHksIG11dGF0ZSkgPT4ge1xyXG4gICAgY29uc3QgdGV4dExlbmd0aCA9IGJvZHkubGVuZ3RoO1xyXG4gICAgaWYgKCh0ZXh0TGVuZ3RoICE9PSAwICYmIHRleHRMZW5ndGggJSA1ID09PSAwKSB8fCB0ZXh0TGVuZ3RoID09PSAxKSB7XHJcbiAgICAgIHRoaXMuZW1pdFR5cGluZ0V2ZW50KG11dGF0ZSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnNldFN0YXRlKHsgYm9keSB9KTtcclxuICB9XHJcblxyXG4gIGVtaXRUeXBpbmdFdmVudCA9IGFzeW5jIChtdXRhdGUpID0+IHtcclxuICAgIGlmICh0aGlzLmNvbnRleHQudXNlcikge1xyXG4gICAgICBhd2FpdCBtdXRhdGUoe1xyXG4gICAgICAgIG11dGF0aW9uOiBlbWl0VHlwaW5nRXZlbnQsXHJcbiAgICAgICAgdmFyaWFibGVzOiB7XHJcbiAgICAgICAgICB1c2VybmFtZTogdGhpcy5jb250ZXh0LnVzZXJcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG5cclxuICAgIHZhciBtaW4gPSAxO1xyXG4gICAgdmFyIG1heCA9IDEwMDtcclxuICAgIHZhciByYW5kID0gIG1pbiArIChNYXRoLnJhbmRvbSgpICogKG1heC1taW4pKTtcclxuICAgIHZhciB1bmlUaW1lID0gbmV3IERhdGUoKS50b1VUQ1N0cmluZygpO1xyXG4gICAgdmFyIG9yZGVyVGltZSA9IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCk7XHJcbiAgICB2YXIgY3VyRGF0ZSA9IG5ldyBEYXRlKCk7XHJcblxyXG4gICAgcmV0dXJuIChcclxuICAgICAgPE11dGF0aW9uXHJcbiAgICAgICAgbXV0YXRpb249e2luc2VydE1lc3NhZ2V9XHJcbiAgICAgICAgdmFyaWFibGVzPXt7XHJcbiAgICAgICAgICBtZXNzYWdlOiB7XHJcbiAgICAgICAgICAgIGlkOiByYW5kLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLmNvbnRleHQudXNlcixcclxuICAgICAgICAgICAgZnJvbTogdGhpcy5jb250ZXh0LnVzZXIsXHJcbiAgICAgICAgICAgIGJvZHk6IHRoaXMuc3RhdGUuYm9keSxcclxuICAgICAgICAgICAgdGltZTogb3JkZXJUaW1lLFxyXG4gICAgICAgICAgICB0aW1lc3RhbXA6IHVuaVRpbWUsXHJcbiAgICAgICAgICAgIGRhdGU6IGN1ckRhdGVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9fVxyXG4gICAgICAgIHVwZGF0ZT17KGNhY2hlLCB7IGRhdGE6IHsgaW5zZXJ0X21lc3NhZ2UgfX0pID0+IHtcclxuICAgICAgICAgIHRoaXMucHJvcHMubXV0YXRpb25DYWxsYmFjayhcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIGlkOiBpbnNlcnRfbWVzc2FnZS5yZXR1cm5pbmdbMF0uaWQsXHJcbiAgICAgICAgICAgICAgdGltZXM6IGluc2VydF9tZXNzYWdlLnJldHVybmluZ1swXS50aW1lLFxyXG4gICAgICAgICAgICAgIHVzZXJuYW1lOiBpbnNlcnRfbWVzc2FnZS5yZXR1cm5pbmdbMF0udXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgYm9keTogaW5zZXJ0X21lc3NhZ2UucmV0dXJuaW5nWzBdLmJvZHksXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfX1cclxuICAgICAgPlxyXG4gICAgICAgIHtcclxuICAgICAgICAgIChpbnNlcnRfbWVzc2FnZSwgeyBkYXRhLCBsb2FkaW5nLCBlcnJvciwgY2xpZW50fSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzZW5kTWVzc2FnZSA9IChlKSA9PiB7IFxyXG4gICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5ib2R5ID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpbnNlcnRfbWVzc2FnZSgpO1xyXG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgYm9keTogXCJcIlxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm0oc2VuZE1lc3NhZ2UsIGNsaWVudCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgPC9NdXRhdGlvbj5cclxuICAgIClcclxuICB9XHJcblxyXG4gIGZvcm0gPSAoc2VuZE1lc3NhZ2UsIGNsaWVudCkgPT4ge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPGZvcm0gb25TdWJtaXQ9e3NlbmRNZXNzYWdlfT5cclxuICAgICAgXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2x1bW5cIj5cclxuICAgICAgICAgIDxUeXBpbmdJbmRpY2F0b3IgdXNlcm5hbWU9e3RoaXMuY29udGV4dC51c2VyfSAvPlxyXG4gICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgIGlkPVwidGV4dGJveFwiXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIm1lc3NhZ2UtYm94XCJcclxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJUeXBlIGEgTWVzc2FnZS4uLlwiXHJcbiAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmJvZHl9XHJcbiAgICAgICAgICAgIGF1dG9Gb2N1cz17dHJ1ZX1cclxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVUeXBpbmcoZS50YXJnZXQudmFsdWUsIGNsaWVudC5tdXRhdGUpO1xyXG4gICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICBhdXRvQ29tcGxldGU9XCJvblwiXHJcbiAgICAgICAgICAvPlxyXG4gICAgICAgICAgPHN0eWxlIGpzeD57YFxyXG5cclxuLmNvbHVtbiB7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gIGJvcmRlci13aWR0aDogMXB4O1xyXG4gIGxpc3Qtc3R5bGU6IG5vbmU7XHJcbiAgcGFkZGluZy1ib3R0b206IDI4cHg7XHJcbiAgbWFyZ2luLXJpZ2h0OiAyOHB4O1xyXG59XHJcblxyXG4udG8ge1xyXG4gIHdpZHRoOiAyNjBweDtcclxuICBwYWRkaW5nLWJvdHRvbTogOHB4O1xyXG4gIHBhZGRpbmctdG9wOiA4cHg7XHJcbiAgYm9yZGVyOiAxcHggc29saWQgI2QwZDRkOTsgXHJcbiAgYm9yZGVyLXJhZGl1czogLjM3NXJlbTtcclxuICAtd2Via2l0LWJveC1zaGFkb3c6IGluc2V0IDAgLTFweCAwIDAgcmdiYSgxMDAsMTIxLDE0MywwLjEyMik7XHJcbiAgYm94LXNoYWRvdzogaW5zZXQgMCAtMXB4IDAgMCByZ2JhKDEwMCwxMjEsMTQzLDAuMTIyKTtcclxuICBsaW5lLWhlaWdodDogMjBweDtcclxuICBtaW4taGVpZ2h0OiBhdXRvOyBcclxufVxyXG5cclxuLm1lc3NhZ2UtYm94IHtcclxuICB3aWR0aDogMTEwMHB4O1xyXG4gIG92ZXJmbG93OiBhdXRvO1xyXG4gIG1pbi1oZWlnaHQ6IDQycHg7XHJcbiAgaGVpZ2h0OiAzOHB4OyBcclxuICBtYXgtaGVpZ2h0OiAxODBweDsgXHJcbiAgYm9yZGVyLXdpZHRoOiAycHg7XHJcbiAgYm9yZGVyLXN0eWxlOiBzb2xpZDtcclxuICBib3JkZXItY29sb3I6IHJnYigyMzQsIDIzNCwgMjM0KTtcclxuICBib3JkZXItaW1hZ2U6IGluaXRpYWw7XHJcbiAgYm9yZGVyLXJhZGl1czogLjM3NXJlbTtcclxuICBib3JkZXI6IDFweCBzb2xpZCAjYmRjNGM5O1xyXG4gIG91dGxpbmU6IDA7XHJcbiAgYmFja2dyb3VuZDogI2ZmZjtcclxuICByZXNpemU6IG5vbmU7XHJcbiAgYm94LXNoYWRvdzogbm9uZTtcclxuICBjb2xvcjogIzFkMWMxZDtcclxuICAtd2Via2l0LXVzZXItc2VsZWN0OiBhdXRvO1xyXG4gIC1tb3otdXNlci1zZWxlY3Q6IGF1dG87XHJcbiAgLW1zLXVzZXItc2VsZWN0OiBhdXRvO1xyXG4gIHVzZXItc2VsZWN0OiBhdXRvO1xyXG4gIHBhZGRpbmc6IDlweCAyOHB4IDEwcHggMjhweDtcclxufVxyXG5cclxuLmxvZ2luIHtcclxuICBjb2xvcjogI0ZGRjtcclxufVxyXG5cclxuLmFjY291bnQge1xyXG4gIGZvbnQtc2l6ZTogMTNweDtcclxuICBsaW5lLWhlaWdodDogMS45MTY2NztcclxuICBmb250LXdlaWdodDogNDAwO1xyXG4gIGNvbG9yOiAjM2Q0NjRkO1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICNiZGM0Yzk7XHJcbiAgcGFkZGluZzogMy41cHggN3B4O1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICBtYXJnaW4tdG9wOiAyOHB4O1xyXG4gIG1hcmdpbi1sZWZ0OiA4cHg7XHJcbn1cclxuXHJcbi5yb3cge1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgbWFyZ2luOiAtMS41cmVtIDA7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcblxyXG4vLyBDU1Mgb25seSBtZWRpYSBxdWVyeSBmb3IgdGFibGV0XHJcbkBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDk2MHB4KSB7XHJcbiAgLnJvdyB7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgbWFyZ2luOiAtMS41cmVtIDA7XHJcbiAgfVxyXG4gIC5jb2x1bW4ge1xyXG4gICAgd2lkdGg6IDglO1xyXG4gICAgcGFkZGluZzogMS41cmVtIDA7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBtYXgtd2lkdGg6IDEwMHB4O1xyXG4gIH1cclxuXHJcbiAgLm1lc3NhZ2UtYm94IHtcclxuICAgIHBhZGRpbmctYm90dG9tOiAyOHB4O1xyXG4gICAgd2lkdGg6IDQwMHB4O1xyXG4gICAgbWluLWhlaWdodDogNDJweDsgXHJcbiAgICBoZWlnaHQ6IDM4cHg7IFxyXG4gICAgbWF4LWhlaWdodDogMTgwcHg7IFxyXG4gICAgYm9yZGVyLXdpZHRoOiAycHg7XHJcbiAgICBib3JkZXItc3R5bGU6IHNvbGlkO1xyXG4gICAgbWFyZ2luLWxlZnQ6IC0zM3B4O1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAyMHB4O1xyXG4gICAgYm9yZGVyLWNvbG9yOiByZ2IoMjM0LCAyMzQsIDIzNCk7XHJcbiAgICBib3JkZXItaW1hZ2U6IGluaXRpYWw7XHJcbiAgICBib3JkZXItcmFkaXVzOiAuMzc1cmVtO1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgI2JkYzRjOTtcclxuICAgIG91dGxpbmU6IDA7XHJcbiAgICBiYWNrZ3JvdW5kOiAjRkZGRkZGO1xyXG4gICAgcmVzaXplOiBub25lO1xyXG4gICAgYm94LXNoYWRvdzogbm9uZTtcclxuICAgIGNvbG9yOiAjMWQxYzFkO1xyXG4gICAgcGFkZGluZzogOXB4IDMwcHggMTBweCA1MHB4O1xyXG4gIH1cclxuXHJcbiAgXHJcbn1cclxuYH08L3N0eWxlPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Zvcm0+XHJcbiAgICApO1xyXG4gIH1cclxufSJdfQ== */\\n/*@ sourceURL=C:\\\\\\\\covid19\\\\\\\\client\\\\\\\\src\\\\\\\\components\\\\\\\\messages\\\\\\\\Textbox.js */\")));\n    });\n\n    _this.state = {\n      user: _this.context,\n      body: \"\",\n      random: 0,\n      curTime: \"\",\n      curDate: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(Textbox, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var min = 1;\n      var max = 100;\n      var rand = min + Math.random() * (max - min);\n      var uniTime = new Date().toUTCString();\n      var orderTime = new Date().toLocaleTimeString();\n      var curDate = new Date();\n      return __jsx(Mutation, {\n        mutation: insertMessage,\n        variables: {\n          message: {\n            id: rand.toString(),\n            username: this.context.user,\n            from: this.context.user,\n            body: this.state.body,\n            time: orderTime,\n            timestamp: uniTime,\n            date: curDate\n          }\n        },\n        update: function update(cache, _ref) {\n          var insert_message = _ref.data.insert_message;\n\n          _this2.props.mutationCallback({\n            id: insert_message.returning[0].id,\n            times: insert_message.returning[0].time,\n            username: insert_message.returning[0].username,\n            body: insert_message.returning[0].body\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 7\n        }\n      }, function (insert_message, _ref2) {\n        var data = _ref2.data,\n            loading = _ref2.loading,\n            error = _ref2.error,\n            client = _ref2.client;\n\n        var sendMessage = function sendMessage(e) {\n          e.preventDefault();\n\n          if (_this2.state.body === '') {\n            return;\n          }\n\n          insert_message();\n\n          _this2.setState({\n            body: \"\"\n          });\n        };\n\n        return _this2.form(sendMessage, client);\n      });\n    }\n  }]);\n\n  return Textbox;\n}(React.Component);\n\n_defineProperty(Textbox, \"contextType\", UserContext);\n\nexport { Textbox as default };","map":{"version":3,"sources":["C:/covid19/client/src/components/messages/Textbox.js"],"names":["React","Mutation","gql","TypingIndicator","distanceInWordsToNow","isToday","useContext","UserContext","insertMessage","emitTypingEvent","Textbox","props","body","mutate","textLength","length","setState","context","user","mutation","variables","username","sendMessage","client","state","e","handleTyping","target","value","random","curTime","curDate","min","max","rand","Math","uniTime","Date","toUTCString","orderTime","toLocaleTimeString","message","id","toString","from","time","timestamp","date","cache","insert_message","data","mutationCallback","returning","times","loading","error","preventDefault","form","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Mutation } from 'react-apollo';\r\nimport gql from 'graphql-tag';\r\nimport TypingIndicator from './TypingIndicator';\r\nimport { distanceInWordsToNow, isToday } from 'date-fns';\r\nimport { useContext } from 'react';\r\nimport UserContext from '../UserContext';\r\n\r\nconst insertMessage = gql`\r\nmutation insert_message ($message: message_insert_input! ){\r\n  insert_message (\r\n    objects: [$message]\r\n  ) {\r\n    returning {\r\n      id\r\n      time\r\n      body\r\n      username\r\n    }\r\n  }\r\n}\r\n`;\r\n\r\nconst emitTypingEvent = gql`\r\nmutation ($username: String) {\r\n  update_users (\r\n    _set: {\r\n      last_typed: \"now()\"\r\n    }\r\n    where: {\r\n      username: {\r\n        _eq: $username\r\n      }\r\n    }\r\n  ) {\r\n    affected_rows\r\n  }\r\n}\r\n`;\r\n\r\n\r\nexport default class Textbox extends React.Component {\r\n\r\n  static contextType = UserContext;\r\n  constructor(props) {\r\n    super()\r\n    this.state = {\r\n      user: this.context,\r\n      body: \"\",\r\n      random: 0,\r\n      curTime: \"\",\r\n      curDate: \"\"\r\n    }\r\n  }\r\n  \r\n\r\n  handleTyping = (body, mutate) => {\r\n    const textLength = body.length;\r\n    if ((textLength !== 0 && textLength % 5 === 0) || textLength === 1) {\r\n      this.emitTypingEvent(mutate);\r\n    }\r\n    this.setState({ body });\r\n  }\r\n\r\n  emitTypingEvent = async (mutate) => {\r\n    if (this.context.user) {\r\n      await mutate({\r\n        mutation: emitTypingEvent,\r\n        variables: {\r\n          username: this.context.user\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    var min = 1;\r\n    var max = 100;\r\n    var rand =  min + (Math.random() * (max-min));\r\n    var uniTime = new Date().toUTCString();\r\n    var orderTime = new Date().toLocaleTimeString();\r\n    var curDate = new Date();\r\n\r\n    return (\r\n      <Mutation\r\n        mutation={insertMessage}\r\n        variables={{\r\n          message: {\r\n            id: rand.toString(),\r\n            username: this.context.user,\r\n            from: this.context.user,\r\n            body: this.state.body,\r\n            time: orderTime,\r\n            timestamp: uniTime,\r\n            date: curDate\r\n          }\r\n        }}\r\n        update={(cache, { data: { insert_message }}) => {\r\n          this.props.mutationCallback(\r\n            {\r\n              id: insert_message.returning[0].id,\r\n              times: insert_message.returning[0].time,\r\n              username: insert_message.returning[0].username,\r\n              body: insert_message.returning[0].body,\r\n            }\r\n          );\r\n        }}\r\n      >\r\n        {\r\n          (insert_message, { data, loading, error, client}) => {\r\n            const sendMessage = (e) => { \r\n              e.preventDefault();\r\n              if (this.state.body === '') {\r\n                return;\r\n              }\r\n              insert_message();\r\n              this.setState({\r\n                body: \"\"\r\n              });\r\n            }\r\n            return this.form(sendMessage, client);\r\n          }\r\n        }\r\n\r\n      </Mutation>\r\n    )\r\n  }\r\n\r\n  form = (sendMessage, client) => {\r\n    return (\r\n      <form onSubmit={sendMessage}>\r\n      \r\n        <div className=\"column\">\r\n          <TypingIndicator username={this.context.user} />\r\n          <input\r\n            id=\"textbox\"\r\n            className=\"message-box\"\r\n            placeholder=\"Type a Message...\"\r\n            value={this.state.body}\r\n            autoFocus={true}\r\n            onChange={(e) => {\r\n              this.handleTyping(e.target.value, client.mutate);\r\n            }}\r\n            autoComplete=\"on\"\r\n          />\r\n          <style jsx>{`\r\n\r\n.column {\r\n  text-align: center;\r\n  border-width: 1px;\r\n  list-style: none;\r\n  padding-bottom: 28px;\r\n  margin-right: 28px;\r\n}\r\n\r\n.to {\r\n  width: 260px;\r\n  padding-bottom: 8px;\r\n  padding-top: 8px;\r\n  border: 1px solid #d0d4d9; \r\n  border-radius: .375rem;\r\n  -webkit-box-shadow: inset 0 -1px 0 0 rgba(100,121,143,0.122);\r\n  box-shadow: inset 0 -1px 0 0 rgba(100,121,143,0.122);\r\n  line-height: 20px;\r\n  min-height: auto; \r\n}\r\n\r\n.message-box {\r\n  width: 1100px;\r\n  overflow: auto;\r\n  min-height: 42px;\r\n  height: 38px; \r\n  max-height: 180px; \r\n  border-width: 2px;\r\n  border-style: solid;\r\n  border-color: rgb(234, 234, 234);\r\n  border-image: initial;\r\n  border-radius: .375rem;\r\n  border: 1px solid #bdc4c9;\r\n  outline: 0;\r\n  background: #fff;\r\n  resize: none;\r\n  box-shadow: none;\r\n  color: #1d1c1d;\r\n  -webkit-user-select: auto;\r\n  -moz-user-select: auto;\r\n  -ms-user-select: auto;\r\n  user-select: auto;\r\n  padding: 9px 28px 10px 28px;\r\n}\r\n\r\n.login {\r\n  color: #FFF;\r\n}\r\n\r\n.account {\r\n  font-size: 13px;\r\n  line-height: 1.91667;\r\n  font-weight: 400;\r\n  color: #3d464d;\r\n  border: 1px solid #bdc4c9;\r\n  padding: 3.5px 7px;\r\n  border-radius: 4px;\r\n  margin-top: 28px;\r\n  margin-left: 8px;\r\n}\r\n\r\n.row {\r\n  flex-direction: column;\r\n  margin: -1.5rem 0;\r\n  text-align: center;\r\n}\r\n\r\n// CSS only media query for tablet\r\n@media screen and (max-width: 960px) {\r\n  .row {\r\n    flex-direction: column;\r\n    margin: -1.5rem 0;\r\n  }\r\n  .column {\r\n    width: 8%;\r\n    padding: 1.5rem 0;\r\n    text-align: center;\r\n    max-width: 100px;\r\n  }\r\n\r\n  .message-box {\r\n    padding-bottom: 28px;\r\n    width: 400px;\r\n    min-height: 42px; \r\n    height: 38px; \r\n    max-height: 180px; \r\n    border-width: 2px;\r\n    border-style: solid;\r\n    margin-left: -33px;\r\n    margin-right: 20px;\r\n    border-color: rgb(234, 234, 234);\r\n    border-image: initial;\r\n    border-radius: .375rem;\r\n    border: 1px solid #bdc4c9;\r\n    outline: 0;\r\n    background: #FFFFFF;\r\n    resize: none;\r\n    box-shadow: none;\r\n    color: #1d1c1d;\r\n    padding: 9px 30px 10px 50px;\r\n  }\r\n\r\n  \r\n}\r\n`}</style>\r\n        </div>\r\n      </form>\r\n    );\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}